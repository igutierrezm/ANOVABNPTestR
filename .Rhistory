set.seed(1)
N <- 1000
lambda <- 1
alpha <- 0.5
Xmat <- matrix(1L, nrow = N, ncol = 1)
yvec <- rpois(N, lambda) + rbinom(N, 1, alpha)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat)
devtools::load_all(".")
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <-  1.2 * (x == 2L) * d + rnorm(N) / 2
}
# Fit our ANOVA BNP model
fit <- anova_bnp_normal(yvec, Xmat, n = 100L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
lambda <- 1
alpha <- 0.5
Xmat <- matrix(1L, nrow = N, ncol = 1)
yvec <- rpois(N, lambda) + rbinom(N, 1, alpha)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat)
# Simulate a sample
{
set.seed(1)
N <- 1000
lambda <- 1
alpha <- 0.5
Xmat <- matrix(1L, nrow = N, ncol = 1)
yvec <- rpois(N, lambda) + rbinom(N, 1, alpha)
}
devtools::load_all(".")
# Simulate a sample
{
set.seed(1)
N <- 1000
lambda <- 1
alpha <- 0.5
Xmat <- matrix(1L, nrow = N, ncol = 1)
yvec <- rpois(N, lambda) + rbinom(N, 1, alpha)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <-  1.2 * (x == 2L) * d + rnorm(N) / 2
}
# Fit our ANOVA BNP model
fit <- anova_bnp_normal(yvec, Xmat, n = 100L)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- runif <= 0.5 + 0.2 * (x == 2L) * d
}
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
# yvec <- runif <= 0.5 + 0.2 * (x == 2L) * d
}
# Fit our ANOVA BNP model
fit <- anova_bnp_normal(yvec, Xmat, n = 100L)
# Fit our ANOVA BNP model
fit <- anova_bnp_bernoulli(yvec, Xmat, n = 100L)
# Fit our ANOVA BNP model
fit <- anova_bnp_bernoulli(yvec, Xmat)
yvec
yvec <- runif(N) <= (0.5 + 0.2 * (x == 2L) * d)
yvec
# Fit our ANOVA BNP model
fit <- anova_bnp_bernoulli(yvec, Xmat)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- runif(N) <= (0.5 + 0.2 * (x == 2L) * d)
}
devtools::load_all(".")
# Fit our ANOVA BNP model
fit <- anova_bnp_bernoulli(yvec, Xmat)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
lambda <- 1
alpha <- 0.5
Xmat <- matrix(1L, nrow = N, ncol = 1)
yvec <- rpois(N, lambda) + rbinom(N, 1, alpha)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- 1.2 * (x == 2L) * d + rnorm(N) / 2
}
devtools::load_all(".")
# Fit our ANOVA BNP model
fit <- anova_bnp_normal(yvec, Xmat, n = 100L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- runif(N) <= (0.5 + 0.2 * (x == 2L) * d)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_bernoulli(yvec, Xmat)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
lambda <- 1
alpha <- 0.5
Xmat <- matrix(1L, nrow = N, ncol = 1)
yvec <- rpois(N, lambda) + rbinom(N, 1, alpha)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat)
devtools::load_all(".")
# Simulate a sample
{
set.seed(1)
N <- 1000
lambda <- 1
alpha <- 0.5
Xmat <- matrix(1L, nrow = N, ncol = 1)
yvec <- rpois(N, lambda) + rbinom(N, 1, alpha)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat)
devtools::load_all(".")
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat)
fit
# Simulate a sample
{
set.seed(1)
N <- 1000
lambda <- 1
alpha <- 0.5
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- rpois(N, lambda) + rbinom(N, 1, alpha)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat)
# Show MCMC results for gamma
gamma_chain(fit)
devtools::load_all(".")
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- rpois(N, 2 + d * (x == 2)) + rbinom(N, 1, 0.5)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
2e6 / 16e3
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- runif(N) <= (0.5 + 0.2 * (x == 2L) * d)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_bernoulli(yvec, Xmat)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Summarize the posterior distribution of gamma
gamma_post(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- rpois(N, 2 + d * (x == 2)) + rbinom(N, 1, 0.5)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- 1.2 * (x == 2L) * d + rnorm(N) / 2
}
# Fit our ANOVA BNP model
fit <- anova_bnp_normal(yvec, Xmat, n = 100L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
# Fit our ANOVA BNP model
fit <- anova_bnp_normal(yvec, Xmat, n = 100L, iter = 10000L, warmup = 6000L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- 1.2 * (x == 2L) * d + rnorm(N) / 2
}
# Fit our ANOVA BNP model
fit <- anova_bnp_normal(yvec, Xmat, n = 100L, iter = 10000L, warmup = 6000L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- rpois(N, 2 + d * (x == 2)) + rbinom(N, 1, 0.5)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat, iter = 10000L, warmup = 6000L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- rpois(N, 3 + 2 * d * (x == 2)) + rbinom(N, 1, 0.5)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat, iter = 10000L, warmup = 6000L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- runif(N) <= (0.5 + 0.2 * (x == 2L) * d)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_bernoulli(yvec, Xmat, iter = 10000L, warmup = 6000L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- runif(N) <= (0.5 + 0.3 * (x == 2L) * d)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_bernoulli(yvec, Xmat, iter = 10000L, warmup = 6000L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
library(devtools)
use_package("tidyr")
# Show the posterior distribution of gamma
gamma_post(fit)
fit$gamma_post
fit$gamma_post |>
dplyr::arrange(dplyr::across(dplyr::starts_with("Sepal"), dplyr::desc))
fit$gamma_post |>
dplyr::arrange(dplyr::across(dplyr::starts_with("group"), dplyr::desc))
devtools::load_all(".")
fit$gamma_post |>
dplyr::arrange(dplyr::starts_with("group"))
fit$gamma_post |>
dplyr::arrange(dplyr::pick(dplyr::starts_with("group")))
devtools::load_all(".")
# Perform our Dunnet-like test
joint_significance_probability(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- runif(N) <= (0.5 + 0.3 * (x == 2L) * d)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_bernoulli(yvec, Xmat, iter = 10000L, warmup = 6000L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
# Perform our Dunnet-like test
joint_significance_probability(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- rpois(N, 3 + 2 * d * (x == 2)) + rbinom(N, 1, 0.5)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat, iter = 10000L, warmup = 6000L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
# Perform our Dunnet-like test
joint_significance_probability(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- 1.2 * (x == 2L) * d + rnorm(N) / 2
}
# Fit our ANOVA BNP model
fit <- anova_bnp_normal(yvec, Xmat, n = 100L, iter = 10000L, warmup = 6000L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
# Perform our Dunnet-like test
joint_significance_probability(fit)
fit$gamma_post |>
dplyr::arrange(dplyr::pick(dplyr::starts_with("group"))) |>
dplyr::slice_head(n = 1) |>
dplyr::pull(prob) |>
tidyr::pivot_longer(-prob)
fit$gamma_post |>
dplyr::arrange(dplyr::pick(dplyr::starts_with("group"))) |>
dplyr::slice_head(n = 1) |>
dplyr::pull(prob)
fit$gamma_post |>
dplyr::arrange(dplyr::pick(dplyr::starts_with("group"))) |>
dplyr::slice_head(n = 1)
fit$gamma_post |>
dplyr::arrange(dplyr::pick(dplyr::starts_with("group"))) |>
dplyr::slice_head(n = 1) |>
tidyr::pivot_longer(-prob)
devtools::load_all(".")
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- 1.2 * (x == 2L) * d + rnorm(N) / 2
}
# Fit our ANOVA BNP model
fit <- anova_bnp_normal(yvec, Xmat, n = 100L, iter = 10000L, warmup = 6000L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
# Perform our Dunnet-like test
joint_significance_probability(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- runif(N) <= (0.5 + 0.3 * (x == 2L) * d)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_bernoulli(yvec, Xmat, iter = 10000L, warmup = 6000L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
# Perform our Dunnet-like test
joint_significance_probability(fit)
# Simulate a sample
{
set.seed(1)
N <- 1000
d <- 2 * (rnorm(N) <= 0.7) - 1
x <- sample(0L:2L, N, replace = TRUE)
Xmat <- matrix(x, nrow = N, ncol = 1)
yvec <- rpois(N, 3 + 2 * d * (x == 2)) + rbinom(N, 1, 0.5)
}
# Fit our ANOVA BNP model
fit <- anova_bnp_berpoi(yvec, Xmat, iter = 10000L, warmup = 6000L)
# Show MCMC results for gamma
gamma_chain(fit)
# Show the factors combination associated to each group
group_codes(fit)
# Show the posterior distribution of gamma
gamma_post(fit)
# Perform our Dunnet-like test
joint_significance_probability(fit)
session_info()
